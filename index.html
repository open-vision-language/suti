<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="bootstrap.min.css" rel="stylesheet" />
    <meta name="twitter:card" content="summary_large_image" />
    <!-- anon-on -->
    <meta name="twitter:site" content="@GoogleAI" />
    <!-- anon-off -->
    <meta name="twitter:title" content="SuTI: A Generalizable Subject-driven Text-to-Image Generator" />
    <meta name="twitter:description" content="In this paper, we present SuTI, a Subject-driven Text-to-Image generator that replaces subject-specific fine tuning with \emph{in-context} learning. Given a few demonstrations of a new subject, SuTI can instantly generate novel renditions of the subject in different scenes, without any subject-specific optimization." />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="styles.css" />

    <script src="jquery.min.js"></script>
    <script src="jquery.flip.min.js"></script>

    <title>SuTI: A Generalizable Subject-driven Text-to-Image Generator</title>
  </head>
  <body>
    <div id="gallery0" style="padding-top: 50px; padding-bottom: 20px; background-color: rgb(245,245,245);"> 

      <h2 style="text-align: center;">Subject-driven Text-to-Image Generation via</h2>
      
        <h2 style="text-align: center;">Apprenticeship Learning</h2>
      

      <!-- anon-on -->
      <div class="authors text-center">
        <div class="row">
          <div class="col">
            <a href="https://wenhuchen.github.io/">Wenhu Chen</a><sup>1,2*</sup>
          </div>
          <div class="col">
            <a href="https://www.hexianghu.com/">Hexiang Hu</a><sup>1*</sup>
          </div>
          <div class="col">
            <a href="https://cold-winter.github.io/">Yandong Li</a><sup>1</sup>
          </div>
          <div class="col">
            <a href="https://natanielruiz.github.io/">Nataniel Ruiz</a><sup>1</sup>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <a href="https://scholar.google.com/citations?user=vO0VSSYAAAAJ&hl=en">Xuhui Jia</a><sup>1</sup>
          </div>
          <div class="col">
            <a href="https://mingweichang.org/">Ming-Wei Chang</a><sup>1</sup>
          </div>
          <div class="col">
            <a href="http://www.cs.cmu.edu/~wcohen/">William Cohen</a><sup>1</sup>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col">
            <strong>1: </strong><img src="assets/GoogleResearch.svg" alt="Google Research" height=60>
          </div>
          <div class="col">
            <strong>2: </strong><img src="assets/UniversityOfWaterloo.svg" alt="U Waterloo" height=60>
          </div>
        </div>
        <div class="row">
          <div class="col text-small">(*: Core Contribution)</div>
        </div>

        <div class="row mt-1 nomobile">
          <center><a href="https://wenhuchen.github.io/images/DreamDiffuser.pdf" target="_blank"><img class="thumbnail" src="assets/paper_thumbnail.png"></a></center>
        </div>
      </div>
      <!-- anon-off -->
    </div>

    <div class="abstract">
      <div class="inside">
        <p class="text">
        Recent text-to-image generation models like DreamBooth have made remarkable progress in generating highly customized images of a target subject, by fine-tuning an `expert model' for a given subject from a few examples. However, this process is expensive, since a new expert model must be learned for each subject. In this paper, we present SuTI, a Subject-driven Text-to-Image generator that replaces subject-specific fine tuning with <i>in-context learning</i>. Given a few demonstrations of a new subject, SuTI can instantly generate novel renditions of the subject in different scenes, without any subject-specific optimization. SuTI is powered by <i>apprenticeship learning</i>, where a single apprentice model is learned from data generated by massive amount of subject-specific expert models. Specifically, we mine millions of image clusters from the Internet, each centered around a specific visual subject. We adopt these clusters to train massive amount of expert models specialized on different subjects. The apprentice model SuTI then learns to mimic the behavior of these experts through the proposed apprenticeship learning algorithm. SuTI can generate high-quality and customized subject-specific images 20x faster than optimization-based SoTA methods. On the challenging DreamBench and DreamBench-v2, our human evaluation shows that SuTI can significantly outperform existing approaches like InstructPix2Pix, Textual Inversion, Imagic, Prompt2Prompt, Re-Imagen while performing on par with DreamBooth.
        </p>
        <!-- anon-on -->
        <a class="read-paper" href="https://wenhuchen.github.io/images/DreamDiffuser.pdf" target="_blank"><button>Research Paper</button></a>
        <!-- anon-off -->
      </div>
    </div>

    <div class="header_dark_gray text-center">
      <h1>Zero-shot Subjec-specific generations on the DreamBench-v2</h1>
    </div>
    <div class="image_8" id="gallery1">
      <div class="flipcard" id="fig0">
        <div class="front">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
        <div class="back">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
      </div>
      <div class="flipcard nomobile" id="fig1">
        <div class="front">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
        <div class="back">
          <figure>
            <img />
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
      </div>
      <div class="flipcard nomobile" id="fig2">
        <div class="front">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
        <div class="back">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
      </div>
      <div class="flipcard nomobile" id="fig3">
        <div class="front">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
        <div class="back">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
      </div>
      <div class="flipcard nomobile" id="fig4">
        <div class="front">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
        <div class="back">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
      </div>
      <div class="flipcard nomobile" id="fig5">
        <div class="front">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
        <div class="back">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
      </div>
      <div class="flipcard nomobile" id="fig6">
        <div class="front">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
        <div class="back">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
      </div>
      <div class="flipcard nomobile" id="fig7">
        <div class="front">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
        <div class="back">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
      </div>
    </div>

    <div class="header_dark_gray text-center">
      <h1>SuTI behaves adaptively as the # of in-context examples increases</h1>
      <h7>When # of in-context examples = 0, SuTI generates its text-only prior;</h7> <br/>
      <h7>When # of in-context examples = 1, SuTI behaves similar to image editing model;</h7> <br/>
      <h7>When # of in-context examples > 1, SuTI generates novel poses/views of the subject.</h7>
    </div>

    <div class="header_dark_gray text-center">
      <h1>Failure modes of the SuTI</h1>
    </div>

    <div class="image_3x2" id="gallery2">
      <div class="flipcard" id="fig0">
        <div class="front">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
      </div>
      <div class="flipcard nomobile" id="fig1">
        <div class="front">
          <figure>
            <img src="">
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
      </div>
      <div class="flipcard nomobile" id="fig2">
        <div class="front">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
      </div>
      <div class="flipcard nomobile" id="fig3">
        <div class="front">
          <figure>
            <img>
            <figcaption class="question"></figcaption>
            <figcaption class="answer"></figcaption>
          </figure>
        </div>
      </div>
    </div>

<!-- anon-on -->
<div class="content">
  <h1>Special Thanks</h1>
  <p class="smaller" style="text-align: justify;">We thank Boqing Gong, Kaifeng Chen, Steve Seitz, Nicole Brichtova, Andrew Bunner and Jason Baldridge for reviewing on an early version of this paper in depth, with valuable comments and suggestions. We thank Yang Zhao and Shiran Zada for the tons of help and supports on running baseline on the proposed dreambench-v2 dataset. We also thank Kenton Lee for discussions and feedback on the project. Additionally, we thank OVEN and OPERA Team for providing their website template.</p>
</div>
<!-- anon-off -->

<script type="text/javascript">

  gallery_images = [
  {
    "src": "./images/oven-images/fungi1.png",
    "question": "<span style='color: #c994c7'>Query</span>: Which species of fungi is this?",
    "answer": "<span style='color: #dd1c77'>Entity</span>: <a href='https://en.wikipedia.org/wiki/Omphalotus_illudens' target='_blank'>Omphalotus illudens (Q7090729)</a>"
  },
  {
    "src": "./images/oven-images/bird1.png",
    "question": "<span style='color: #c994c7'>Query</span>: What is the species of this animal?",
    "answer": "<span style='color: #dd1c77'>Entity</span>: <a href='https://en.wikipedia.org/wiki/Ash-throated_flycatcher' target='_blank'>Ash-throated flycatcher (Q650369)</a>",
  },
  {
    "src": "./images/oven-images/mountain1.png",
    "question": "<span style='color: #c994c7'>Query</span>: What is this mountain called?",
    "answer": "<span style='color: #dd1c77'>Entity</span>: <a href='https://en.wikipedia.org/wiki/Sawtooth_Range_(Idaho)' target='_blank'>Sawtooth Range (Q7428707)</a>",
  },
  {
    "src": "./images/oven-images/food1.png",
    "question": "<span style='color: #c994c7'>Query</span>: What dish is pictured?",
    "answer": "<span style='color: #dd1c77'>Entity</span>: <a href='https://en.wikipedia.org/wiki/Ceviche' target='_blank'>Ceviche (Q1057953)</a>",
  },
  {
    "src": "./images/oven-images/beer1.png",
    "question": "<span style='color: #c994c7'>Query</span>: What brand of beer is in the bucket?",
    "answer": "<span style='color: #dd1c77'>Entity</span>: <a href='https://en.wikipedia.org/wiki/Estrella_Galicia' target='_blank'>Estrella Galicia (Q3394030)</a>",
  },
  {
    "src": "./images/oven-images/aircraft1.png",
    "question": "<span style='color: #c994c7'>Query</span>: What model of aircraft is shown?",
    "answer": "<span style='color: #dd1c77'>Entity</span>: <a href='https://en.wikipedia.org/wiki/Cessna_172' target='_blank'>Cessna 172 (Q244479)</a>"
  },
  {
    "src": "./images/oven-images/shoe1.png",
    "question": "<span style='color: #c994c7'>Query</span>: What kind of shoes is this person wearing?",
    "answer": "<span style='color: #dd1c77'>Entity</span>: <a href='https://en.wikipedia.org/wiki/Flip-flops' target='_blank'>Flip-flops (Q380339)</a>",
  },
  {
    "src": "./images/oven-images/material1.png",
    "question": "<span style='color: #c994c7'>Query</span>: What is that statue made out of?",
    "answer": "<span style='color: #dd1c77'>Entity</span>: <a href='https://en.wikipedia.org/wiki/Cast_iron' target='_blank'>Cast iron (Q483269)</a>",
  },
  {
    "src": "./images/oven-images/car1.png",
    "question": "<span style='color: #c994c7'>Query</span>: What is the make and model of this car?",
    "answer": "<span style='color: #dd1c77'>Entity</span>: <a href='https://en.wikipedia.org/wiki/Nissan_Juke' target='_blank'>Nissan Juke (Q1415815)</a>"
  },
  {
    "src": "./images/oven-images/place1.png",
    "question": "<span style='color: #c994c7'>Query</span>: What is the place these guys are fighting called?",
    "answer": "<span style='color: #dd1c77'>Entity</span>: <a href='https://en.wikipedia.org/wiki/Wrestling_ring' target='_blank'> Wrestling ring (Q6763849)</a>",
  },
  {
    "src": "./images/oven-images/food2.png",
    "question": "<span style='color: #c994c7'>Query</span>: What is the name of the dish shown?",
    "answer": "<span style='color: #dd1c77'>Entity</span>: <a href='https://en.wikipedia.org/wiki/French_onion_soup' target='_blank'>French onion soup (Q244617)</a>"
  },
  {
    "src": "./images/oven-images/place2.png",
    "question": "<span style='color: #c994c7'>Query</span>: What is the name of the location at the end of the street?",
    "answer": "<span style='color: #dd1c77'>Entity</span>: <a href='https://en.wikipedia.org/wiki/Palais_Longchamp' target='_blank'>Palais Longchamp (Q1619084)</a>"
  },
  ];

  lastCardFlippedIdx = {
    gallery1: -1,
  };

  lastCardFlippedLastSwapTime = {
    gallery1: -1,
  };

  $(".flipcard").flip({
    trigger: "manual",
    reverse: false,
  });

  function checkIfImageIsVisible(name, image) {
    numCards = $(name + " .flipcard:visible").size();

    for (var cardIdx = 0; cardIdx < numCards; ++cardIdx) {
      var isFlipped = $(name + " #fig" + cardIdx).data("flip-model").isFlipped;
      if (!isFlipped) {
        src = $(name + " #fig" + cardIdx + " div.front figure img").attr("src")
      } else {
        src = $(name + " #fig" + cardIdx + " div.back figure img").attr("src")
      }

      if (image.src == src) {
        return true;
      }
    }
    return false;
  }

  function getNextImage(name) {
    // different galleries have different sources of imagery.
    img_src = gallery_images;
    while (true) {
      randomImageIdx = Math.floor(Math.random() * img_src.length);
      if (!checkIfImageIsVisible(name, img_src[randomImageIdx])) {
        return img_src[randomImageIdx];
      }
    }
  }

  function randomSwapImageWithId(name, randomCardIdx) {
    numCards = $(name + " .flipcard:visible").size();

    image = getNextImage(name);

    const d = new Date();
    let currentTime = d.getTime();
    lastCardFlippedIdx[name] = randomCardIdx;
    lastCardFlippedLastSwapTime[name] = currentTime;

    var isFlipped = $(name + " #fig" + randomCardIdx).data("flip-model").isFlipped;
    if (!isFlipped) {
      $(name + " #fig" + randomCardIdx + " div.back figure img").attr("src", image.src)
      $(name + " #fig" + randomCardIdx + " div.back figure figcaption.question").html(image.question)
      $(name + " #fig" + randomCardIdx + " div.back figure figcaption.answer").html(image.answer)
    } else {
      $(name + " #fig" + randomCardIdx + " div.front figure img").attr("src", image.src)
      $(name + " #fig" + randomCardIdx + " div.front figure figcaption.question").html(image.question)
      $(name + " #fig" + randomCardIdx + " div.front figure figcaption.answer").html(image.answer)
    }

    $(name + " #fig" + randomCardIdx).flip("toggle");
  }

  function randomSwapImage(name) {
    numCards = $(name + " .flipcard:visible").size();

    const d = new Date();
    if (d.getTime() - lastCardFlippedIdx[name] < 5000) {
      setTimeout(randomSwapImage, 1000, name);
      return;
    }

    do {
      randomCardIdx = Math.floor(Math.random() * numCards);
      if (numCards == 1) {
        break;
      }
    } while (randomCardIdx == lastCardFlippedIdx[name]);

    randomSwapImageWithId(name, randomCardIdx);
    setTimeout(randomSwapImage, 3000, name);
  }

  function setupGallery1(id) {
        randomSwapImageWithId("#gallery1", id);
        $("#gallery1 #fig" + id).click(
          function() {
            randomSwapImageWithId("#gallery1", id);
          }
        );
  }
  for (id = 0; id < 8; id ++) {
        setupGallery1(id);
  }

  setTimeout(randomSwapImage, 1000, "#gallery1");
</script>

<script type="text/javascript">
  compositionalAnimalsManualClicked = false;
  compositionalMadeOfManualClicked = false;

  comp_files = {
    "Original (with mask)": "./images/inpaint/boston_masked.jpg",
    "\"New York in the background\"": "./images/inpaint/boston_nyc.jpg",
    "\"Paris in the background\"": "./images/inpaint/boston_paris.jpg",
    "\"San Francisco in the background\"": "./images/inpaint/boston_sf.jpg"
  }

  function updateComposition(name) {
    var compositionSpans = $(name + " p span.selected").map(function() {
      return $(this).text();
    }).get();
    var compositionText = "";
    for (var compositionSpansIdx = 0; compositionSpansIdx < compositionSpans.length; ++compositionSpansIdx) {
      if (compositionSpansIdx > 0) {
        compositionText += " ";
      }
      compositionText += compositionSpans[compositionSpansIdx];
    }
    if (name == "#compositional_madeof") {
      if (compositionText == "Original") {
        $(name + "_img").attr("src", "./images/edit_opt/orig.gif")
      } else {
        // Generate a random index that is not the one already selected
        randImgIdx = "/"; // something guaranteed to be in the path
        cur_src = $(name + "_img").attr("src");
        while (cur_src.search(randImgIdx) != -1) {
          randImgIdx = Math.floor(Math.random() * 4);
        }
        first_space = compositionText.search(" ");
        file = compositionText.slice(first_space + 1, -2).replaceAll(" ", "-");
        $(name + "_img").attr("src", "./images/edit_opt/" + file + "_" + randImgIdx + ".gif")
      }
    } else if (name == "#compositional_animals") {
      randImgIdx = Math.floor(Math.random() * 4);
      $(name + "_img").attr("src", comp_files[compositionText]);
    }
  }

  function randomComposition(name) {
    if (name == "#compositional_animals" && compositionalAnimalsManualClicked == true) {
      compositionalAnimalsManualClicked = false;
      setTimeout(randomComposition, 4000, name);
      return;
    } else if (name == "#compositional_madeof" &&
               compositionalMadeOfManualClicked == true) {
      compositionalMadeOfManualClicked = false;
      setTimeout(randomComposition, 4000, name);
      return;
    }

    var compositionPs = $(name + " p.selectable").toArray();
    var compositionOptions = [];
    for (var i = 0; i < compositionPs.length; ++i) {
      var compositionSpanSelected = $(compositionPs[i]).children("span.selected");
      var compositionSpans = $(compositionPs[i]).children("span").not("span.selected").toArray();
      for (var j = 0; j < compositionSpans.length; ++j) {
        compositionOption = {
          "p": compositionPs[i],
          "span_selected": compositionSpanSelected,
          "span_option": $(compositionSpans[j])
        };
        compositionOptions.push(compositionOption);
      }
    }

    randomCompositionOptionIdx = Math.floor(Math.random() * compositionOptions.length);
    randomCompositionOption = compositionOptions[randomCompositionOptionIdx];

    randomCompositionOption.span_selected.toggleClass("selected");
    randomCompositionOption.span_option.toggleClass("selected");

    updateComposition(name);
    setTimeout(randomComposition, 4000, name);
  }

  $("#compositional_animals p.selectable span").click(function() {
    $(this).siblings().removeClass("selected");
    $(this).addClass("selected");
    updateComposition("#compositional_animals");
    compositionalAnimalsManualClicked = true;
  });
  $("#compositional_madeof_img").click(function() {
    updateComposition("#compositional_madeof");
    compositionalAnimalsManualClicked = true;
  });

  $("#compositional_madeof p.selectable span").click(function() {
    $(this).siblings().removeClass("selected");
    $(this).addClass("selected");
    updateComposition("#compositional_madeof");
    compositionalMadeOfManualClicked = true;
  });

  <!-- setTimeout(randomComposition, 2000, "#compositional_animals"); -->
  <!-- setTimeout(randomComposition, 4000, "#compositional_madeof"); -->
</script>
<script src="bootstrap.bundle.min.js"></script>
  </body>
</html>